import * as geom from 'toxiclibsjs/geom';

export default function sketch(s) {
  let SutherlandHodgemanClipper = geom.SutherlandHodgemanClipper;
  let tlarg = 200;
  // let n = 0;
  let len;
  let letras = [];
  let scale = 1;
  let segs = ["0ta","0tb","1ra","1rb","2a","3ma","3mb","4ma","4mb","5a"];
  let pos = [0,0,1,1,2,3,3,4,4,5];
  let tramax = [];
  let tramay = [];
  let ix,iy;
  let lfundo = [];
  let numx,numy;
  numx = 9;
  numy = 4;

  s.setup = () => {
    s.createCanvas(tlarg*numx*scale, tlarg*numy*scale);
    s.colorMode(s.HSL,100);
    //s.background(1,100,100);
    ix = s.floor(0 + s.random(2));
    tramax.push([ix,ix+1,ix+2,ix+3,ix+4,ix+5,ix+6]);
    iy = s.floor(1 + s.random(1));
    tramay.push(iy);
    
    for(let i = 0; i < segs.length; i++){
      letras.push(new TLetter(s,segs[i],scale,ix+pos[i],iy,0,0,0));
    }
    
    s.background(255);
  
    for(let i = 0; i < numx*numy * 1; i++){
       let rnum = s.floor(s.random(segs.length));
       let prob = 0.1666;
       let px,py;
       px = i%numx;
       py = (s.floor(i/numx))%numy;
       if(s.random(1.0) < prob && (tramax.indexOf(px) < 0) && (tramay.indexOf(py) < 0)){
       lfundo.push(new TLetter(s,segs[rnum],scale,px,py,0,0,s.floor(s.random(8))/2));
       }
    }

    s.noStroke();


    lfundo.forEach(function(i) {
      //fill(random(90,120),20,20,random(190,220));
      s.fill(4,[25,50,75].choose(),[70,80,90].choose(),[0.25,0.50,75].choose);
      i.display()
    }) 

    for(let i = 0; i < letras.length; i++){
    
      if(i<4){
      s.fill(4,77,48);//,random(230,235));
      }else{
      s.fill(0,0,33);//,random(230,235));
      }
      letras[i].display();
    }
  
     
    
    
  };

  //  s.draw = () => {
  //   n += 0.1;
  //   console.log(n);
  //  }
  //   for(let i = 0; i<10; i++){
  //   c = c + rate;
  //   lastx = x;
  //   lasty = y;
  //   x = s.sin(c*fr1)*(width/2) + width/2;
  //   y = s.sin(c*fr2)*(height/2) + height/2;
  //   // s.background(backgroundColor);
  //   if(c>rate){
  //   s.strokeWeight(s.random(0.5,2));
  //   s.stroke(s.color(s.cos(c*fr1/2)*150+100, s.cos(c+0.9)*60+50, s.sin(c*fr2/2)*50+200));
  //   s.line(x,y,lastx,lasty)
  //   }
  // }
  // };
  //    console.log(x);

}





class TLetter {
  constructor(_p,type,scale,x,y,padx,pady,rot) {
    
    this.p = _p; 
    this.xarr = [];
    this.yarr = [];

    if(type == "0ta"){
      //this.xarr = [71.42857,71.42845,71.561584,72.042145,72.76812,73.72649,74.90419,76.28822,77.86554,79.62311,81.54789,83.626854,85.84697,88.1952,90.65851,93.22386,95.878235,98.60859,100.000534,100.000534,99.263855,97.82323,96.42836,95.08644,93.80463,92.59011,91.45007,90.39169,89.42215,88.54863,87.778305,87.11836,86.57598,86.15834,85.87261,85.72598,85.71332,85.71324,71.42857,71.42857];
      //this.yarr = [-3.8146973E-6,71.43112,72.928925,75.84897,78.666466,81.36827,83.94121,86.37213,88.64787,90.75528,92.6812,94.41246,95.93591,97.23839,98.30674,99.12781,99.68842,99.97543,100.0,85.71341,85.701004,85.55487,85.26963,84.85245,84.3105,83.65098,82.88105,82.00789,81.03868,79.980606,78.840836,77.62655,76.344925,75.00314,73.608376,72.1678,71.43112,0.0,-3.8146973E-6,-3.8146973E-6];
        this.xarr = [71.42785,71.42773,71.56086,72.04142,72.7674,73.72577,74.9035,76.28754,77.86486,79.62243,81.54723,83.62621,85.846344,88.19458,90.65791,93.22329,95.87767,98.60804,100.0,100.0,98.532455,95.742714,93.17907,90.89897,88.95989,87.41923,86.33446,85.763,85.71269,85.71261,71.42785,71.42785];
        this.yarr = [-6.567645E-4,71.43093,72.92876,75.84881,78.66634,81.36815,83.94112,86.37204,88.6478,90.75521,92.68115,94.41242,95.935875,97.23837,98.30673,99.127815,99.688416,99.97545,100.0,85.713326,85.66353,85.09303,84.00914,82.46928,80.530846,78.25128,75.68803,72.898476,71.43095,-6.567645E-4,-6.567645E-4,-6.567645E-4];
    }
    if(type == "0tb"){
       this.xarr = [42.855705,42.855705,100.0,99.97286,42.855705,42.855705];
       this.yarr = [14.286643,28.571487,28.571487,14.286643,14.286643,14.286643];
    }
    if(type == "1ra"){
      this.xarr = [-0.04860476,-0.04860476,57.093227,57.090767,-0.04860476,-0.04860476];
      this.yarr = [85.66387,99.95117,99.95117,85.66387,85.66387,85.66387];
    }
    if(type == "1rb"){
      this.xarr = [80.903755,78.94104,75.102745,71.38621,67.81057,64.39488,61.158318,58.11994,55.29888,52.71424,50.385124,48.330658,46.569935,45.122078,44.006187,43.241375,42.846745,42.81084,42.809593,42.80838,42.80838,42.80838,42.80838,57.09322,57.09322,57.093185,57.09322,57.090763,57.11427,57.362762,57.842297,58.540924,59.44673,60.547783,61.83216,63.28792,64.90315,66.66592,68.5643,70.58636,72.72018,74.95382,77.275375,79.67288,80.898834,80.92716,80.95545,80.95545,100.01176,100.01176,80.95545,80.903755,80.903755];
      this.yarr = [14.2372,14.270566,14.660232,15.420241,16.531515,17.974962,19.731497,21.782038,24.107504,26.688808,29.506859,32.54258,35.776886,39.190685,42.7649,46.48044,50.318226,52.280903,52.30685,52.332565,85.663864,85.663864,99.95117,99.95117,52.332577,52.30686,52.280907,52.280907,51.05501,48.658024,46.337498,44.105354,41.973488,39.953804,38.058197,36.298573,34.686832,33.234886,31.954634,30.857975,29.95681,29.26305,28.788591,28.545338,28.524513,28.525723,28.526974,28.522211,28.522211,14.237363,14.237363,14.2372,14.2372];
    }    
    if(type == "2a"){
      this.xarr = [57.14474,54.934456,50.612164,46.427208,42.40113,38.55547,34.911777,31.4916,28.316483,25.407974,22.787613,20.47695,18.49753,16.8709,15.618603,14.76219,14.323201,14.285714,14.323201,14.76219,15.618606,16.870905,18.497541,20.476969,22.787643,25.40802,28.31655,31.491695,34.911903,38.555634,42.401333,46.427467,50.61248,54.934837,57.145164,100.00214,100.00214,57.14516,55.6717,52.790302,50.000458,47.31652,44.75287,42.323845,40.043823,37.92716,35.988213,34.24135,32.70092,31.381308,30.296848,29.46192,28.890879,28.598087,28.573015,28.597965,28.890541,29.461405,30.296192,31.380543,32.700092,34.240475,35.98733,37.9263,40.04301,42.3231,44.75222,47.315987,50.000053,52.79005,55.67161,57.14516,58.61852,61.499664,64.289215,66.97282,69.53612,71.964806,74.24453,76.36094,77.34572,78.29969,80.04645,81.58681,82.906425,83.9909,84.825874,85.39695,85.68978,85.71486,85.71486,99.999695,99.999695,100.00215,99.96467,99.52574,98.66942,97.41722,95.79071,93.81143,91.50091,88.880684,85.97232,82.79734,79.3773,75.73373,71.88817,67.86217,63.67728,59.355015,57.14474,57.14474];
      this.yarr = [14.285714,14.323242,14.762284,15.618722,16.871017,18.497627,20.477005,22.787619,25.407919,28.316372,31.491426,34.911552,38.5552,42.40083,46.4269,50.611874,54.934204,57.14453,59.35485,63.677177,67.862144,71.88821,75.733826,79.37744,82.79751,85.9725,88.880875,91.50107,93.81154,95.79076,97.41717,98.66923,99.52541,99.96416,100.001526,100.001526,85.71422,85.71422,85.68928,85.39673,84.825935,83.991234,82.907005,81.587585,80.04737,78.300674,76.3619,74.245384,71.96549,69.53658,66.973015,64.289154,61.49936,58.617985,57.14453,55.67098,52.789417,49.99942,47.315353,44.751587,42.322468,40.042374,37.925663,35.986702,34.239845,32.699455,31.379911,30.295559,29.46077,28.889904,28.597328,28.572382,28.593273,28.837257,29.313099,30.008833,30.912487,32.012093,33.295666,34.751263,35.546234,36.366886,38.130596,40.030415,42.054398,44.19057,46.42697,48.751656,51.152645,52.38045,71.429375,71.429375,52.38045,52.38045,50.41579,46.573845,42.853985,39.275364,35.857132,32.61843,29.57842,26.756248,24.171064,21.842012,19.788248,18.028921,16.58318,15.470176,14.709057,14.318975,14.285714,14.285714];
    }
    if(type == "3ma"){
      this.xarr = [42.857143,0.0,0.0,42.857143,42.857143,42.857143];
      this.yarr = [85.71429,85.71429,100.0,100.0,85.71429,85.71429];
    }
    

    if(type == "3mb"){
      this.xarr = [71.431595,69.22126,64.8989,60.71388,56.687744,52.842033,49.19831,45.778107,42.60296,39.69443,37.074062,34.763386,32.783966,31.157328,29.905033,29.048618,28.609634,28.572147,28.520473,28.51801,42.807774,42.807774,42.807774,42.807774,42.85699,42.88206,43.17485,43.745895,44.58082,45.665268,46.98489,48.52531,50.27217,52.211124,54.32779,56.60781,59.03683,61.600487,64.284424,67.07428,69.95567,71.42914,72.90251,75.78372,78.57336,81.257095,83.82054,86.24936,88.52918,90.645645,92.58441,94.3311,95.87136,97.19085,98.275185,99.11002,99.68099,99.97375,99.998825,99.998825,98.50866,95.35847,92.02496,88.53096,84.899254,81.15264,77.31393,73.40592,71.431595,71.431595];
      this.yarr = [14.2848425,14.322202,14.760942,15.617116,16.86918,18.495594,20.47481,22.785284,25.405478,28.313837,31.488827,34.908905,38.55252,42.39813,46.4242,50.609165,54.93151,57.141834,57.141834,99.95209,99.95209,57.146782,57.144318,57.14202,57.14202,55.66855,52.787178,49.99738,47.31352,44.749954,42.321045,40.041157,37.92464,35.985863,34.239178,32.69895,31.379545,30.295317,29.46062,28.889822,28.59728,28.572336,28.597406,28.890163,29.461138,30.295975,31.38031,32.699787,34.240055,35.98674,37.925495,40.041965,42.321793,44.750603,47.314053,49.997784,52.787434,55.668648,57.14202,25.235323,23.939783,21.598518,19.564896,17.847652,16.455536,15.39728,14.681629,14.317324,14.2848425,14.2848425];
    }    
    if(type == "4ma"){
      this.xarr = [0.0,0.0,14.279915,14.284956,14.282376,14.23809,13.732358,12.749942,11.3174,9.461285,7.2081547,4.5845666,1.6170782,0.0,0.0];
      this.yarr = [25.203335,99.998825,99.998825,71.41276,57.119682,54.75174,50.129997,45.669037,41.395306,37.33524,33.5153,29.96191,26.701527,25.203335,25.203335];
    }
    if(type == "4mb"){
      this.xarr = [42.854527,40.6453,36.325058,32.14202,28.117722,24.273674,20.631401,17.212425,14.038266,11.13045,8.510494,6.1999216,4.220254,2.5930123,1.3397188,0.4818944,0.041060816,0.0024607826,-1.1798915E-4,0.0049215653,14.287304,14.287304,14.313491,14.608188,15.180767,16.016882,17.102184,18.422335,19.962984,21.709791,23.648407,25.764492,28.043695,30.47168,33.03409,35.716587,38.50483,41.384468,42.85699,44.329514,47.209152,49.99739,52.679886,55.242302,57.67028,59.949486,62.06557,64.00419,65.75099,67.29164,68.61179,69.69709,70.5332,71.10579,71.4005,71.426674,71.426674,85.70905,85.714096,85.71152,85.67291,85.23208,84.37425,83.12098,81.49374,79.51405,77.20348,74.583534,71.675705,68.50155,65.08257,61.440308,57.596256,53.571953,49.388924,45.068672,42.85945,42.85699,42.854527,42.854527];
      this.yarr = [14.2848425,14.322301,14.760951,15.616724,16.868103,18.49357,20.471615,22.780716,25.399364,28.306042,31.47923,34.89742,38.539085,42.38272,46.406803,50.589825,54.91027,57.119682,71.412735,99.998825,99.998825,57.119682,55.64704,52.7674,49.979393,47.29738,44.735676,42.308624,40.03055,37.91579,35.978683,34.23356,32.694736,31.376575,30.293392,29.459524,28.889305,28.597067,28.572147,28.597067,28.889305,29.459524,30.293392,31.376575,32.694736,34.23356,35.978683,37.91579,40.03055,42.308624,44.735676,47.29738,49.979393,52.7674,55.64704,57.119682,99.998825,99.998825,71.412735,57.119682,54.91027,50.589825,46.406803,42.38272,38.539085,34.89742,31.47923,28.306042,25.399364,22.780716,20.471615,18.49357,16.868103,15.616724,14.760951,14.322301,14.2848425,14.2848425,14.2848425,14.2848425];
    }
    if(type == "5a"){
      this.xarr = [42.859028,40.64874,36.32645,32.141495,28.115414,24.269754,20.626064,17.205887,14.03077,11.122258,8.501898,6.191236,4.2118163,2.5851858,1.3328899,0.47647503,0.03748669,0.0,0.037486907,0.4764759,1.3328924,2.5851912,4.2118273,6.1912546,8.501928,11.122304,14.030836,17.205978,20.626184,24.269915,28.115616,32.141754,36.326763,40.649124,42.85945,100.0,100.0,42.85945,41.385994,38.504597,35.714745,33.030807,30.467154,28.038132,25.758112,23.641445,21.702497,19.955633,18.415207,17.09559,16.011135,15.176207,14.605166,14.312376,14.287304,14.312251,14.604828,15.175693,16.01048,17.094831,18.41438,19.954762,21.701618,23.640585,25.757298,28.037394,30.466507,33.03028,35.714336,38.504333,41.3859,42.85945,44.332813,47.213963,50.003506,52.687103,55.25042,57.679108,59.95882,62.075226,63.060013,64.01399,65.76073,67.30111,68.62072,69.705185,70.54016,71.11124,71.40407,71.42914,71.42914,85.71398,85.71644,85.678955,85.24003,84.383705,83.13151,81.505,79.52572,77.215195,74.59497,71.68661,68.51163,65.09158,61.44801,57.60246,53.57646,49.39156,45.069305,42.859028,42.859028];
      this.yarr = [14.285714,14.323242,14.762284,15.618722,16.871017,18.497627,20.477005,22.787619,25.407919,28.316372,31.491426,34.911552,38.5552,42.40083,46.4269,50.611874,54.934204,57.14453,59.35485,63.677177,67.862144,71.88821,75.733826,79.37744,82.79751,85.9725,88.880875,91.50107,93.81154,95.79076,97.41717,98.66923,99.52541,99.96416,100.001526,100.001526,85.71422,85.71422,85.68928,85.39673,84.825935,83.991234,82.907005,81.587585,80.04737,78.300674,76.3619,74.245384,71.96549,69.53658,66.973015,64.289154,61.49936,58.61799,57.14453,55.67098,52.789417,49.99942,47.31536,44.751587,42.32247,40.042377,37.92567,35.986702,34.239845,32.699455,31.379911,30.295559,29.460772,28.88991,28.59733,28.572384,28.593279,28.837263,29.313105,30.008839,30.912493,32.012096,33.295673,34.751266,35.54624,36.366894,38.130604,40.030426,42.0544,44.190582,46.42698,48.75166,51.152653,52.38046,71.42938,71.42938,52.380463,50.415802,46.573853,42.853992,39.27537,35.857136,32.61844,29.578426,26.756252,24.171064,21.842012,19.788248,18.028921,16.58318,15.470176,14.709057,14.318975,14.285714,14.285714];
    } 
        
      this.x = x;
      this.y = y;
      this.scale = scale;
      this.padx = padx;
      this.pady = pady;   
      this.rot = rot;   
      let arrayx = this.xarr;
      this.arrlen = arrayx.length;
    }

    display() { 
      const { p } = this; 
    //translate(this.x*this.scale*100 - 50*this.scale, this.y*this.scale*100 - 50*this.scale); 
    p.push();
    
    p.strokeJoin(p.ROUND);
    p.translate((100 * this.x + 50.0) * this.scale, (100 * this.y + 50.0) * this.scale);
    p.rotate(this.rot * p.HALF_PI);
    p.beginShape();
      for(let i = 0; i < this.arrlen; i++){
        let px,py;
        px = p.round(this.xarr[i]*100)/100;
        py = p.round(this.yarr[i]*100)/100;
       p.vertex((px*this.scale + this.padx*this.scale*100/7) + this.x*this.scale*100 - ((100 * this.x + 50.0) * this.scale), (py*this.scale + this.pady*this.scale*100/7) + this.y*this.scale*100 - (100 * this.y + 50.0) * this.scale); 
      }
    p.endShape();
    
    p.pop();
  }
}




Array.prototype.choose = function () {
  return this[Math.floor((Math.random()*this.length))];
}